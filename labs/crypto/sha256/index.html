<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="dark light" />
    <meta name="author" content="Siavash Ashkiani" />
    <meta name="description"
        content="Interactive SHA-256 playground: input -> bytes -> padding -> blocks -> rounds -> digest." />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://siavash.ashkiani.com/labs/crypto/sha256/" />
    <link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">

    <title>SHA-256 Playground · Crypto Lab</title>

    <link rel="stylesheet" href="/assets/style.css" />
    <link rel="stylesheet" href="/labs/assets/style.css" />
</head>

<body>
    <div class="bg"></div>
    <div class="page">
        <div id="site-header"></div>

        <main class="wrap">
            <section class="card">
                <div class="crumbs">
                    <a href="/labs/">Labs</a> <span class="muted">/</span>
                    <a href="/labs/crypto/">Crypto</a> <span class="muted">/</span>
                    <span>SHA-256</span>
                </div>

                <h2>SHA-256 Playground (end-to-end)</h2>
                <p class="muted">
                    Type into the input box: the SHA-256 digest updates instantly, and this page shows the exact
                    intermediate values (bytes, padding, blocks, message schedule, and rounds).
                </p>
            </section>

            <section class="card">
                <h3>How SHA-256 turns your input into a digest</h3>
                <p class="muted">
                    SHA-256 is a <strong>hash function</strong>: it takes an input of any length and produces a
                    fixed-size
                    <strong>256-bit</strong> output (usually shown as <strong>64 hex characters</strong>).
                    Small input changes cause large, unpredictable output changes (“avalanche effect”).
                </p>

                <p class="muted">
                    Internally, SHA-256 processes the message in a pipeline:
                </p>

                <ol class="muted" style="margin-top:10px">
                    <li><strong>Encode to bytes</strong> (because hashing works on bytes, not characters).</li>
                    <li><strong>Pad</strong> so the length becomes a clean multiple of 512 bits.</li>
                    <li><strong>Split into 512-bit blocks</strong> (64 bytes each) and process them one by one.</li>
                    <li><strong>For each block:</strong> build a 64-word schedule W[0..63] and run 64 compression
                        rounds.</li>
                    <li><strong>Combine</strong> the final internal state into the 256-bit digest.</li>
                </ol>

                <p class="muted" style="margin-top:10px">
                    This page shows every stage <em>live</em>. Use “Inspect block” and “Inspect round” to zoom in.
                </p>
            </section>

            <section class="card">
                <div class="controls">
                    <label class="control" style="flex:1; min-width:240px">
                        <span class="control-label">Input</span>
                        <textarea id="input" class="textarea" rows="4" placeholder="Type text…"></textarea>
                    </label>

                    <div style="display:flex; flex-direction:column; gap:10px">
                        <label class="control control-toggle">
                            <input id="treatAsHex" type="checkbox" />
                            <span>Treat input as hex bytes</span>
                        </label>

                        <label class="control control-toggle">
                            <input id="showAscii" type="checkbox" checked />
                            <span>Show ASCII hint</span>
                        </label>

                        <label class="control">
                            <span class="control-label">Inspect block</span>
                            <select id="blockSelect" class="control-input"></select>
                        </label>

                        <label class="control">
                            <span class="control-label">Inspect round t</span>
                            <input id="roundRange" class="control-input" type="range" min="0" max="63" value="0" />
                            <span id="roundValue" class="mono">0</span>
                        </label>

                        <div style="display:flex; gap:10px; flex-wrap:wrap">
                            <button id="stepBack" class="btn" type="button">◀︎</button>
                            <button id="stepFwd" class="btn" type="button">▶︎</button>
                            <button id="runFull" class="btn" type="button">Jump to round 63</button>
                        </div>
                    </div>
                </div>

                <div id="inputError" class="hint" style="margin-top:10px; display:none"></div>
            </section>

            <section class="card">
                <h3>Output digest (updates as you type)</h3>
                <p class="muted">
                    The digest shown here is the final 256-bit result after processing <em>all</em> blocks. “WebCrypto
                    verification”
                    is included so you can confirm the playground is computing the same SHA-256 as your browser’s
                    built-in implementation.
                </p>
                <div class="io-grid" style="margin-top:12px">
                    <div>
                        <div class="kpi">
                            <div class="kpi-label">Digest (this playground)</div>
                            <div class="hash-row">
                                <div id="digestLocal" class="kpi-value mono hash"></div>
                                <button id="copyLocal" class="btn btn-sm" type="button">Copy</button>
                            </div>
                            <div class="kpi-sub muted">Computed by the same code that produces the intermediate values
                                below.</div>
                        </div>
                    </div>

                    <div>
                        <div class="kpi">
                            <div class="kpi-label">Digest (WebCrypto verification)</div>
                            <div class="hash-row">
                                <div id="digestWeb" class="kpi-value mono hash"></div>
                                <button id="copyWeb" class="btn btn-sm" type="button">Copy</button>
                            </div>
                            <div class="kpi-sub muted">Browser built-in SHA-256 (sanity check).</div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="card">
                <h3>1) Raw bytes</h3>
                <p class="muted">
                    SHA-256 operates on <strong>bytes</strong>. If you type normal text, the browser converts it to
                    <strong>UTF-8</strong>
                    bytes first. The same visible text can produce different bytes under different encodings, which is
                    why “bytes” is the
                    real input to the hash function.
                </p>
                <p class="muted">
                    If you enable <strong>Treat input as hex bytes</strong>, your input is interpreted as raw bytes
                    (e.g. <span class="mono">61 62 63</span>)
                    instead of text. This is useful when you want to hash binary data or test exact byte sequences.
                </p>
                <div class="kpi-grid" style="margin-top:12px">
                    <div class="kpi">
                        <div class="kpi-label">Byte length</div>
                        <div class="kpi-value mono" id="rawLenBytes">—</div>
                    </div>
                    <div class="kpi">
                        <div class="kpi-label">Bit length</div>
                        <div class="kpi-value mono" id="rawLenBits">—</div>
                    </div>
                    <div class="kpi">
                        <div class="kpi-label">Total blocks</div>
                        <div class="kpi-value mono" id="blockCount">—</div>
                    </div>
                    <div class="kpi">
                        <div class="kpi-label">Length field (8 bytes)</div>
                        <div class="kpi-value mono" id="lenField">—</div>
                    </div>
                </div>

                <div class="mono bytes" id="rawBytes" style="margin-top:14px"></div>
            </section>

            <section class="card">
                <h3>2) Padding</h3>
                <p class="muted">
                    SHA-256 appends <span class="mono">0x80</span>, then <span class="mono">0x00</span> until the
                    message length is
                    56 mod 64, then appends the original bit-length as 8 bytes (big-endian).
                </p>
                <p class="muted">
                    Why padding exists: SHA-256 must end on an exact <strong>512-bit boundary</strong> because the
                    algorithm processes fixed-size
                    blocks. The “56 mod 64” rule reserves the last <strong>8 bytes</strong> of the final block for the
                    length field.
                    That length field prevents different messages from accidentally producing the same padded
                    representation.
                </p>
                <div class="legend" style="margin-top:10px">
                    <span class="legend-item"><span class="swatch sw80"></span> 0x80 byte</span>
                    <span class="legend-item"><span class="swatch swln"></span> length field</span>
                </div>

                <div class="mono bytes" id="paddedBytes" style="margin-top:14px"></div>
            </section>

            <section class="card">
                <h3>3) 512-bit blocks</h3>
                <p class="muted">
                    After padding, the message is split into <strong>512-bit blocks</strong> (64 bytes each). SHA-256
                    processes these blocks
                    <strong>in order</strong>. Each block updates an internal 256-bit state, and the next block starts
                    from that updated state
                    (this is called <strong>chaining</strong>).
                </p>
                <p class="muted">
                    “Total blocks” above tells you how many blocks your padded message contains. For short inputs, it’s
                    usually 1 block.
                    Longer inputs become multiple blocks, and the final digest depends on <em>all</em> blocks in
                    sequence.
                </p>
                <div id="blocks"></div>
            </section>

            <section class="card">
                <h3>4) Message schedule W[0..63] (selected block)</h3>
                <p class="muted">
                    Each 512-bit block is first viewed as <strong>16 words</strong> of 32 bits (W[0..15]). SHA-256 then
                    expands them into
                    a <strong>64-word message schedule</strong> W[0..63]. This expansion mixes earlier words so that
                    each round depends on
                    more than just a single part of the input (increasing <strong>diffusion</strong>).
                </p>
                <p class="muted">
                    Each compression round uses one schedule word W[t]. Click a cell to jump directly to that round.
                </p>
                <div id="wGrid" class="wgrid"></div>
            </section>

            <section class="card">
                <h3>5) Compression round (selected block, selected round)</h3>
                <p class="muted">
                    This is the core of SHA-256. For the selected block, SHA-256 runs <strong>64 rounds</strong>. In
                    each round, it updates
                    eight 32-bit working registers: <span class="mono">a b c d e f g h</span>.
                </p>
                <p class="muted">
                    Conceptually, each round:
                    (1) combines the current state with the schedule word <span class="mono">W[t]</span> and a fixed
                    constant <span class="mono">K[t]</span>,
                    (2) computes two temporary values <span class="mono">T1</span> and <span class="mono">T2</span>,
                    and (3) shifts/mixes the registers to form the next state.
                    These repeated mixing steps are what produce the “random-looking” digest.
                </p>
                <p class="muted">
                    Use “Inspect round t” to step through rounds. The “Before/After” boxes show how the internal state
                    changes.
                    The “Round formulas” box shows the exact computed intermediate values for that round.
                </p>
                <div class="controls" style="margin-top:10px">
                    <div class="kpi" style="flex:1; min-width:240px">
                        <div class="kpi-label">Round</div>
                        <div class="kpi-value mono" id="roundMeta">t=0</div>
                        <div class="kpi-sub mono" id="roundMeta2">W[t]=— K[t]=—</div>
                        <div class="kpi-sub mono" id="roundMeta3">T1=— T2=—</div>
                    </div>

                    <div class="kpi" style="flex:1; min-width:240px">
                        <div class="kpi-label">Click a register</div>
                        <div class="kpi-value mono" id="regTitle">—</div>
                        <div class="kpi-sub mono" id="regExplain">Click any a..h box to see how it updates.</div>
                        <div class="kpi-sub mono" id="regExplain2"></div>
                    </div>
                </div>

                <div class="viz-grid" style="margin-top:14px">
                    <div class="card-inner">
                        <h4>Before round</h4>
                        <div id="regsBefore" class="regs"></div>
                    </div>

                    <div class="card-inner">
                        <h4>After round</h4>
                        <div id="regsAfter" class="regs"></div>
                    </div>
                </div>

                <div class="card-inner" style="margin-top:14px">
                    <h4>Round formulas (exact)</h4>
                    <div class="mono pre" id="formulaBox"></div>
                </div>
            </section>
        </main>

        <div id="site-footer"></div>
    </div>

    <script defer src="/assets/site.js"></script>
    <script defer src="./sha256.js"></script>
</body>

</html>